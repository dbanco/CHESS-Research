%% Load in different solutions and compute their objective values

% True solution
[y,y_true,K,J,N,M,T,Xtrue,Dtrue,scales] = gaus_linear_osc_signal_matched_small_zpad2_center(0.01);
center = round((M+1)/2);


sol_files = { 
    'C:\Users\dpqb1\Documents\Outputs\toy3_center_exp_optFlow8_17_X0_D0_V0_zpad_HS0.002_sig_2\output_j1_sig_1.00e-02_lam1_6.00e-02_lam2_0.00e+00.mat',...
    'C:\Users\dpqb1\Documents\Outputs\toy3_center_exp_optFlow8_17_X0_D0_V0_zpad_HS0.0001_sig_2\output_j10_sig_1.00e-02_lam1_6.00e-02_lam2_5.00e-01.mat',...
    'C:\Users\dpqb1\Documents\Outputs\toy3_center_exp_optFlow8_20_X0_D0_V0_zpad_HS0.0001_sig_2\output_j4_sig_1.00e-02_lam1_7.00e-02_lam2_5.00e-03.mat',...
    'C:\Users\dpqb1\Documents\Outputs\toy3_center_exp_optFlow8_20_X0_D0_V0_zpad_HS0.0001_sig_2\output_j8_sig_1.00e-02_lam1_7.00e-02_lam2_1.00e-01.mat',...
    'C:\Users\dpqb1\Documents\Outputs\toy3_center_exp_optFlow8_20_X0_D0_V0_zpad_HS0.0001_sig_2\output_j11_sig_1.00e-02_lam1_7.00e-02_lam2_1.00e+00.mat',...
    "C:\Users\dpqb1\Documents\Outputs\toy3_center_exp_optFlow8_20_X0_D0_V0_zpad_HS0.0001_sig_2\output_j14_sig_1.00e-02_lam1_7.00e-02_lam2_6.00e+00.mat",...
    "C:\Users\dpqb1\Documents\Outputs\toy3_center_exp_optFlow8_20_X0_D0_V0_zpad_HS0.0001_sig_2\output_j20_sig_1.00e-02_lam1_7.00e-02_lam2_3.00e+01.mat",...
    "C:\Users\dpqb1\Documents\Outputs\toy3_center_exp_optFlow8_21_Xtrue_Dtrue_V0_zpad_HS1e-08_sig_2\output_j25_sig_1.00e-02_lam1_6.00e-02_lam2_7.50e+01.mat",...
    "C:\Users\dpqb1\Documents\Outputs\toy3_center_exp_optFlow8_21_Xtrue_Dtrue_V0_zpad_HS1e-08_sig_2\output_j26_sig_1.00e-02_lam1_6.00e-02_lam2_1.00e+02.mat",...
    "C:\Users\dpqb1\Documents\Outputs\toy3_center_exp_optFlow8_21_Xtrue_Dtrue_V0_zpad_HS1e-08_sig_2\output_j27_sig_1.00e-02_lam1_6.00e-02_lam2_2.00e+02.mat",...
    "C:\Users\dpqb1\Documents\Outputs\toy3_center_exp_optFlow8_21_Xtrue_Dtrue_V0_zpad_HS1e-08_sig_2\output_j28_sig_1.00e-02_lam1_6.00e-02_lam2_5.00e+02.mat",...
    "C:\Users\dpqb1\Documents\Outputs\toy3_center_exp_optFlow8_21_Xtrue_Dtrue_V0_zpad_HS1e-08_sig_2\output_j29_sig_1.00e-02_lam1_6.00e-02_lam2_1.00e+03.mat",...
    "C:\Users\dpqb1\Documents\Outputs\toy3_center_exp_optFlow8_21_Xtrue_Dtrue_V0_zpad_HS1e-08_sig_2\output_j30_sig_1.00e-02_lam1_6.00e-02_lam2_2.00e+03.mat",...
    "C:\Users\dpqb1\Documents\Outputs\toy3_center_exp_optFlow8_21_Xtrue_Dtrue_V0_zpad_HS0.0005_sig_2\output_j27_sig_1.00e-02_lam1_6.00e-02_lam2_2.00e+02.mat",...
    "C:\Users\dpqb1\Documents\Outputs\toy3_center_exp_optFlow8_21_Xtrue_Dtrue_V0_zpad_HS0.005_sig_2\output_j27_sig_1.00e-02_lam1_6.00e-02_lam2_2.00e+02.mat",...
    "C:\Users\dpqb1\Documents\Outputs\toy3_center_exp_optFlow8_21_Xtrue_Dtrue_V0_zpad_HS0.005_sig_2\output_j31_sig_1.00e-02_lam1_6.00e-02_lam2_1.00e+05.mat"};

fprintf('Obj        Err       L1        OF        HS \n')
true.D = Dtrue;
true.X = Xtrue;
true.y = y;
true.Uvel = [];
true.Vvel = [];
[obj,Jdf,Jl1,Jof,Jhs] = computeObj(true,scales,center,N,M,K,0,1,1e-8);
fprintf('%9.2e %9.2e %9.2e %9.2e %9.2e \n',obj,Jdf,Jl1,Jof,Jhs)

for i = 1:numel(sol_files)
    load(sol_files{i})

    lam_s = outputs.lambda;
    lam_of = outputs.lambda2;
    lam_hs = outputs.opt.Smoothness;
    [obj,Jdf,Jl1,Jof,Jhs] = computeObj(outputs,scales,center,N,M,K,lam_s,lam_of,lam_hs);
    fprintf('%9.2e %9.2e %9.2e %9.2e %9.2e \n',obj,Jdf,Jl1,Jof,Jhs)
end